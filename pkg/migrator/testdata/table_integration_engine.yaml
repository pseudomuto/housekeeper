description: "Integration engine table modifications use DROP+CREATE strategy"
current_sql: |
  CREATE TABLE analytics.kafka_events (
    id UInt64,
    timestamp DateTime,
    message String
  ) ENGINE = Kafka('topic', 'group');
  
  CREATE TABLE analytics.mysql_users (
    id UInt64,
    name String
  ) ENGINE = MySQL('host:3306', 'db', 'user', 'pass');
target_sql: |
  CREATE TABLE analytics.kafka_events (
    id UInt64,
    timestamp DateTime,
    message String,
    new_field String
  ) ENGINE = Kafka('topic', 'group');
  
  CREATE TABLE analytics.mysql_users (
    id UInt64,
    name String,
    email String
  ) ENGINE = MySQL('host:3306', 'db', 'user', 'pass');
expected_migration:
  sql_contains:
    - "DROP TABLE analytics.kafka_events"
    - "CREATE TABLE analytics.kafka_events"
    - "new_field String"
    - "ENGINE = Kafka('topic', 'group')"
    - "DROP TABLE analytics.mysql_users"
    - "CREATE TABLE analytics.mysql_users"
    - "email String"
    - "ENGINE = MySQL('host:3306', 'db', 'user', 'pass')"
  diff_count: 2
  diff_types:
    - "ALTER"
    - "ALTER"