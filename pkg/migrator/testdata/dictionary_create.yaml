description: "Creating a new dictionary with complex attributes"
current_sql: ""
target_sql: |
  CREATE DICTIONARY IF NOT EXISTS analytics.users_dict ON CLUSTER production (
    user_id UInt64 IS_OBJECT_ID,
    parent_id UInt64 DEFAULT 0 HIERARCHICAL,
    name String,
    email String INJECTIVE,
    status String DEFAULT 'active',
    created_at DateTime EXPRESSION 'now()',
    score Float64 DEFAULT 0.0
  ) PRIMARY KEY user_id, parent_id
  SOURCE(MySQL(host 'localhost' port 3306 user 'root' password 'secret' db 'users' table 'user_data'))
  LAYOUT(COMPLEX_KEY_HASHED(size_in_cells 1000000))
  LIFETIME(MIN 300 MAX 3600)
  SETTINGS(max_threads = 4, max_block_size = 8192)
  COMMENT 'User dictionary with hierarchical structure and caching';
expected_migration:
  up_contains:
    - "CREATE DICTIONARY IF NOT EXISTS analytics.users_dict ON CLUSTER production"
    - "user_id UInt64 IS_OBJECT_ID"
    - "parent_id UInt64 DEFAULT 0 HIERARCHICAL"
    - "email String INJECTIVE"
    - "PRIMARY KEY user_id, parent_id"
    - "SOURCE(MySQL("
    - "LAYOUT(COMPLEX_KEY_HASHED("
    - "LIFETIME(MIN 300 MAX 3600)"
    - "SETTINGS("
    - "COMMENT 'User dictionary with hierarchical structure and caching'"
  down_contains:
    - "DROP DICTIONARY IF EXISTS analytics.users_dict ON CLUSTER production"
  diff_count: 1
  diff_types:
    - "CREATE"