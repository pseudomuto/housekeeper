description: "Database rename operations with intelligent detection"
current_sql: |
  CREATE DATABASE old_analytics ENGINE = Atomic COMMENT 'Analytics database';
  CREATE DATABASE temp_db ON CLUSTER production ENGINE = Memory COMMENT 'Temporary database';
target_sql: |
  CREATE DATABASE analytics ENGINE = Atomic COMMENT 'Analytics database';
  CREATE DATABASE staging_db ON CLUSTER production ENGINE = Memory COMMENT 'Temporary database';
expected_migration:
  up_contains:
    - "RENAME DATABASE old_analytics TO analytics"
    - "RENAME DATABASE temp_db TO staging_db ON CLUSTER production"
  down_contains:
    - "RENAME DATABASE analytics TO old_analytics"
    - "RENAME DATABASE staging_db TO temp_db ON CLUSTER production"
  diff_count: 2
  diff_types:
    - "RENAME"
    - "RENAME"